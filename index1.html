<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ - SUNNY</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πÑ‡∏ï‡∏•‡πå -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        .loader {
            border-top-color: #3b82f6;
            -webkit-animation: spin 1s ease-in-out infinite;
            animation: spin 1s ease-in-out infinite;
        }
        @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .stock-table-container {
            /* overflow-x: auto; ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á ‡πÅ‡∏ï‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å */
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 1px solid #e5e7eb;
        }
        .stock-table th, .stock-table td {
            padding: 1rem; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà padding ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        }
        /* Fade in animation for modal */
        .modal-fade-in {
            animation: fadeIn 0.2s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        /* ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏ß‡∏î‡∏•‡∏≤‡∏¢‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ‡∏î‡πâ‡∏ß‡∏¢ CSS */
        .wooden-blinds-bg {
            background-color: transparent;
            background-image: repeating-linear-gradient(
                180deg,
                rgba(210, 180, 140, 0.15) 0px,      /* ‡∏™‡∏µ‡πÑ‡∏°‡πâ‡∏à‡∏≤‡∏á‡πÜ */
                rgba(210, 180, 140, 0.15) 15px,
                rgba(139, 69, 19, 0.1) 16px,        /* ‡πÄ‡∏á‡∏≤‡∏Ç‡∏≠‡∏ö‡πÑ‡∏°‡πâ */
                rgba(139, 69, 19, 0.1) 18px,
                transparent 18px,
                transparent 22px
            );
            border-bottom: 2px solid rgba(139, 69, 19, 0.1);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4 font-sans">

    <div class="w-full max-w-3xl bg-white p-0 rounded-xl shadow-2xl relative overflow-hidden">
        
        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏•‡∏≤‡∏¢‡∏°‡∏π‡πà‡∏•‡∏µ‡πà -->
        <div class="wooden-blinds-bg p-8 text-center relative">
            <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ (Help Button) -->
            <button onclick="toggleHelpModal(true)" class="absolute top-6 right-6 bg-red-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-red-700 flex items-center gap-2 transition-all duration-200 transform hover:scale-105 z-20">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-sm font-bold">‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ</span>
            </button>

            <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ SUNNY -->
            <div class="mb-2 relative z-10">
                <h1 class="text-5xl font-extrabold text-red-600 tracking-wider italic" style="font-family: 'Arial Black', sans-serif; text-shadow: 2px 2px 0px rgba(0,0,0,0.1);">
                    SUNNY
                </h1>
            </div>

            <!-- ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö -->
            <h2 class="text-3xl font-bold text-gray-800 relative z-10 bg-white/60 inline-block px-4 py-1 rounded-full backdrop-blur-sm">
                ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ
            </h2>
        </div>

        <div class="p-8 pt-4">
            <div class="mb-6 flex gap-4">
                <input
                    type="text"
                    id="productCodeInput"
                    placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô B35-34)"
                    class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg shadow-sm"
                    onkeypress="if(event.key === 'Enter') searchProduct()"
                >
                <button
                    id="searchButton"
                    onclick="searchProduct()"
                    class="flex-shrink-0 bg-blue-600 text-white p-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-150 ease-in-out shadow-md disabled:opacity-50 flex items-center justify-center"
                >
                    ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                </button>
            </div>

            <div id="resultContainer" class="mt-8">
                <p id="initialMessage" class="text-center text-gray-500">
                    ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </p>

                <div id="loadingIndicator" class="hidden flex justify-center items-center py-4">
                    <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-8 w-8"></div>
                    <span class="ml-3 text-blue-600 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î...</span>
                </div>

                <div id="productCard" class="hidden bg-white p-0 rounded-lg shadow-lg border border-gray-200">
                    <div class="bg-blue-600 p-6 rounded-t-lg text-white">
                         <p class="text-sm font-medium opacity-80">‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p>
                         <h2 class="text-3xl font-bold" id="productCodeDisplay"></h2>
                         <p class="text-lg mt-2 opacity-90" id="productName"></p>
                    </div>
                    
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold text-gray-800">üì¶ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡πÉ‡∏ö)</h3>
                            <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏ó‡∏∏‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ</span>
                        </div>
                        
                        <div class="stock-table-container">
                            <table id="stockTable" class="stock-table w-full text-sm text-gray-500 border-collapse">
                                <thead class="text-base text-gray-700 uppercase bg-gray-100">
                                    <!-- Headers ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô JS ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå -->
                                </thead>
                                <tbody class="divide-y divide-gray-200">
                                    <!-- Rows -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div id="lowStockMessage" class="hidden mt-4 text-center p-3 text-sm font-medium text-red-700 bg-red-100 rounded-lg border border-red-300 flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                              <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                            ‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ö‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î (‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 20 ‡∏ä‡∏¥‡πâ‡∏ô)
                        </div>
                    </div>
                </div>

                <div id="errorMessage" class="hidden bg-red-50 border-l-4 border-red-500 text-red-700 p-4 rounded-lg flex items-start gap-3" role="alert">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <div>
                        <p class="font-bold">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                        <p id="errorText"></p>
                    </div>
                </div>
            </div>

            <!-- ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó -->
            <p class="mt-8 text-lg text-red-600 font-bold text-center">
                ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• : <span id="lastUpdateDisplay">-</span>
            </p>
        </div>

    </div>

    <!-- Help Modal (Popup) -->
    <div id="helpModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full p-6 modal-fade-in relative">
            <button onclick="toggleHelpModal(false)" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            
            <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ
            </h3>
            
            <div class="space-y-4 text-gray-700 text-sm md:text-base leading-relaxed">
                <p>
                    <span class="font-bold text-blue-600">‚Ä¢</span> ‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
                </p>
                <p>
                    <span class="font-bold text-blue-600">‚Ä¢</span> ‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ <strong>-</strong> ‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç<br>
                    <span class="text-gray-500 text-sm ml-4">‡πÄ‡∏ä‡πà‡∏ô <strong>B35-30</strong> , <strong>SA-15</strong> , <strong>FW-510</strong> , <strong>FW-356</strong></span>
                </p>
                <p>
                    <span class="font-bold text-blue-600">‚Ä¢</span> ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° <strong>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</strong> ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                </p>
                <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                    <p class="mb-2">
                        <span class="font-bold text-blue-600">‚Ä¢</span> ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 4ft (1.22 ‡∏°.), 4.5ft (1.37 ‡∏°.), 5ft (1.52 ‡∏°.) ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÉ‡∏ö‡∏°‡∏π‡πà‡∏•‡∏µ‡πà
                    </p>
                    <p class="font-medium">
                        ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏ó‡∏µ‡πà 8FT ‡∏•‡∏á‡∏°‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ
                    </p>
                    <p class="text-sm mt-2 text-gray-600 italic">
                        "‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏ô‡∏≤‡∏î‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏ß‡πâ‡∏≤‡∏á 168x200 ‡πÅ‡∏ï‡πà‡∏Ç‡∏ô‡∏≤‡∏î 5.5FT ‡∏´‡∏°‡∏î ‡πÅ‡∏ï‡πà‡∏Ç‡∏ô‡∏≤‡∏î 8FT ‡∏°‡∏µ <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Å‡πá‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏±‡πà‡∏á‡πÑ‡∏î‡πâ (‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°) ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ô‡∏≥‡πÉ‡∏ö 8FT ‡∏°‡∏≤‡∏ï‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏≠‡∏á</strong>"
                    </p>
                </div>
            </div>

            <button onclick="toggleHelpModal(false)" class="mt-6 w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 font-semibold">
                ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß
            </button>
        </div>
    </div>

    <script>
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQz2OtjzRBmeUmLOTSgJ-Bt2woZPiR9QyzvIWcBXacheG3IplefFZE66yWYE43qVRQo2DAOPu9UClh5/pub?gid=1132498145&single=true&output=csv';
        
        let productDataCache = null; 

        // ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Column Index ‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û (A=0, B=1, C=2, D=3, E=4...)
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÄ‡∏°‡∏ï‡∏£‡πÉ‡∏ô Key ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        const STOCK_COLUMNS = {
            '4ft (1.22 ‡∏°.)': 4,
            '4.5ft (1.37 ‡∏°.)': 6,
            '5ft (1.52 ‡∏°.)': 8,
            '5.5ft (1.68 ‡∏°.)': 10,
            '6ft (1.83 ‡∏°.)': 12,
            '6.5ft (1.98 ‡∏°.)': 14,
            '7ft (2.13 ‡∏°.)': 16,
            '8ft (2.44 ‡∏°.)': 18
        };
        const NAME_COLUMN_INDEX = 1; // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå B

        function parseCSV(text) {
            const lines = text.trim().split('\n');
            const data = {};
            let lastProductCode = null; // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏à‡∏≥‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Merged Cells)

            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 2 (index 1) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≤‡∏° Header ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å
            // *‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ñ‡πâ‡∏≤ Header ‡∏°‡∏µ 2 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà index 2 ‡∏´‡∏£‡∏∑‡∏≠ 3 ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡πÑ‡∏ü‡∏•‡πå
            // ‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏û Header ‡∏´‡∏•‡∏±‡∏Å‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 1, Header ‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 2, ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 3
            // ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏° i = 2
            
            for (let i = 2; i < lines.length; i++) {
                // ‡πÉ‡∏ä‡πâ Regex ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏∏‡∏•‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ô "" (‡πÄ‡∏ä‡πà‡∏ô "‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤, ‡∏£‡∏∏‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©")
                // ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤ CSV ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏á‡πà‡∏≤‡∏¢‡πÉ‡∏ä‡πâ split(',') ‡∏Å‡πá‡πÄ‡∏£‡πá‡∏ß‡∏î‡∏µ
                const row = lines[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                
                // ‡∏•‡∏ö quote " ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
                const cleanRow = row.map(cell => cell ? cell.trim().replace(/^"|"$/g, '') : '');

                let productCode = cleanRow[0];

                // --- LOGIC ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ MERGED CELLS ---
                // ‡∏ñ‡πâ‡∏≤‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á ‡πÅ‡∏ï‡πà‡∏ä‡πà‡∏≠‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡πÉ‡∏´‡πâ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
                if (!productCode && lastProductCode) {
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÑ‡∏´‡∏° (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ß‡πà‡∏≤‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå)
                    const hasData = Object.values(STOCK_COLUMNS).some(idx => cleanRow[idx] && cleanRow[idx] !== '0');
                    if (cleanRow[NAME_COLUMN_INDEX] || hasData) {
                        productCode = lastProductCode;
                    }
                }

                if (productCode) {
                    productCode = productCode.toUpperCase();
                    lastProductCode = productCode; // ‡∏à‡∏≥‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤

                    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÉ‡∏ô data ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
                    if (!data[productCode]) {
                        data[productCode] = {
                            name: cleanRow[NAME_COLUMN_INDEX] || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠',
                            stocks: {}
                        };
                        // Initialize stocks ‡πÄ‡∏õ‡πá‡∏ô 0
                        for (const size of Object.keys(STOCK_COLUMNS)) {
                            data[productCode].stocks[size] = 0;
                        }
                    }

                    // ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î (Accumulate) ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡πâ‡∏ô‡πÜ
                    for (const [size, colIndex] of Object.entries(STOCK_COLUMNS)) {
                        if (cleanRow.length > colIndex) {
                            // ‡∏•‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≥‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (‡πÄ‡∏ä‡πà‡∏ô "1,200" -> 1200)
                            const numStr = cleanRow[colIndex].replace(/,/g, '');
                            const val = parseInt(numStr, 10) || 0;
                            data[productCode].stocks[size] += val;
                        }
                    }
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠ (‡∏õ‡∏Å‡∏ï‡∏¥‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏∞‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏™‡∏∏‡∏î)
                    // ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏°‡∏≤‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
                }
            }
            return data;
        }

        async function fetchStockData(productCode) {
            // Force Reload ‡∏ñ‡πâ‡∏≤ Cache ‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤
            if (productDataCache === null) {
                console.log("Fetching data...");
                try {
                    const response = await fetch(CSV_URL);
                    if (!response.ok) throw new Error('Network response error');
                    const csvText = await response.text();
                    productDataCache = parseCSV(csvText);
                    
                    // ‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°
                    const now = new Date();
                    const options = { year: 'numeric', month: 'long', day: 'numeric' };
                    const datePart = now.toLocaleDateString('th-TH', options);
                    const timePart = now.toLocaleTimeString('th-TH');
                    
                    document.getElementById('lastUpdateDisplay').textContent = `${datePart} ‡πÄ‡∏ß‡∏•‡∏≤ ${timePart}`;
                    
                } catch (error) {
                    console.error("Error:", error);
                    return { success: false, message: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï' };
                }
            }

            const key = productCode.toUpperCase().trim();
            const result = productDataCache[key];

            if (result) {
                return { success: true, product: result };
            } else {
                return { success: false, message: `‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${productCode}` };
            }
        }

        async function searchProduct() {
            const input = document.getElementById('productCodeInput');
            const code = input.value.trim();
            
            if (!code) return;

            // UI Elements
            const loader = document.getElementById('loadingIndicator');
            const card = document.getElementById('productCard');
            const errorMsg = document.getElementById('errorMessage');
            const initMsg = document.getElementById('initialMessage');
            const btn = document.getElementById('searchButton');

            // Set UI State
            loader.classList.remove('hidden');
            card.classList.add('hidden');
            errorMsg.classList.add('hidden');
            initMsg.classList.add('hidden');
            btn.disabled = true;

            // Simulate slight delay for UX (optional) or just fetch
            const result = await fetchStockData(code);

            loader.classList.add('hidden');
            btn.disabled = false;

            if (result.success) {
                const p = result.product;
                document.getElementById('productCodeDisplay').textContent = code.toUpperCase();
                document.getElementById('productName').textContent = p.name;
                
                // Render Table (Vertical Layout)
                const thead = document.querySelector('#stockTable thead');
                const tbody = document.querySelector('#stockTable tbody');
                const lowStockMsg = document.getElementById('lowStockMessage');
                
                // ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà (2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå)
                let headHTML = `
                    <tr>
                        <th scope="col" class="px-6 py-3 bg-gray-100 border-b text-left text-gray-600 font-bold w-2/3">‡∏Ç‡∏ô‡∏≤‡∏î (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á)</th>
                        <th scope="col" class="px-6 py-3 bg-gray-100 border-b text-right text-gray-600 font-bold w-1/3">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡πÉ‡∏ö)</th>
                    </tr>
                `;
                
                let bodyHTML = '';
                let hasLowStock = false;

                // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î
                for (const size of Object.keys(STOCK_COLUMNS)) {
                    const qty = p.stocks[size];
                    let colorClass = 'text-gray-900 font-bold';
                    let bgClass = '';
                    let iconHTML = '';
                    
                    if (qty === 0) {
                        // ‡∏Å‡∏£‡∏ì‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î (0)
                        colorClass = 'text-gray-400';
                        // ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô X ‡∏™‡∏µ‡πÅ‡∏î‡∏á
                        iconHTML = `
                            <svg class="w-6 h-6 text-red-500 ml-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        `;
                    } else {
                        // ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (> 0)
                        // ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ñ‡∏π‡∏Å ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                        iconHTML = `
                            <svg class="w-6 h-6 text-green-500 ml-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        `;

                        if (qty < 20) {
                            colorClass = 'text-red-600 font-extrabold';
                            bgClass = 'bg-red-50'; // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏≠‡πà‡∏≠‡∏ô‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                            hasLowStock = true;
                        } else {
                            colorClass = 'text-green-700 font-bold';
                        }
                    }

                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß (Row) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î
                    bodyHTML += `
                        <tr class="hover:bg-gray-50 transition-colors">
                            <td class="px-6 py-4 text-left border-b font-medium text-gray-800">
                                ${size}
                            </td>
                            <td class="px-6 py-4 text-right border-b ${bgClass}">
                                <div class="flex items-center justify-end">
                                    <span class="${colorClass} text-xl">${qty.toLocaleString()}</span>
                                    ${iconHTML}
                                </div>
                            </td>
                        </tr>
                    `;
                }
                
                thead.innerHTML = headHTML;
                tbody.innerHTML = bodyHTML;

                if (hasLowStock) lowStockMsg.classList.remove('hidden');
                else lowStockMsg.classList.add('hidden');

                card.classList.remove('hidden');
            } else {
                errorMsg.classList.remove('hidden');
                document.getElementById('errorText').textContent = result.message;
            }
        }

        // Help Modal Logic
        function toggleHelpModal(show) {
            const modal = document.getElementById('helpModal');
            if (show) {
                modal.classList.remove('hidden');
            } else {
                modal.classList.add('hidden');
            }
        }

        // Close modal when clicking outside
        document.getElementById('helpModal').addEventListener('click', function(e) {
            if (e.target === this) {
                toggleHelpModal(false);
            }
        });
    </script>
</body>
</html>
